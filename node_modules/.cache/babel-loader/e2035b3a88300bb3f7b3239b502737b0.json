{"ast":null,"code":"var events = require('events');\n\nvar inherits = require('util').inherits;\n\nexports.Promise = function () {\n  events.EventEmitter.call(this);\n  this._blocking = false;\n  this.hasFired = false;\n  this.hasAcked = false;\n  this._values = undefined;\n};\n\ninherits(exports.Promise, events.EventEmitter);\n\nexports.Promise.prototype.timeout = function (timeout) {\n  if (!timeout) {\n    return this._timeoutDuration;\n  }\n\n  this._timeoutDuration = timeout;\n  if (this.hasFired) return;\n\n  this._clearTimeout();\n\n  var self = this;\n  this._timer = setTimeout(function () {\n    self._timer = null;\n\n    if (self.hasFired) {\n      return;\n    }\n\n    self.emitError(new Error('timeout'));\n  }, timeout);\n  return this;\n};\n\nexports.Promise.prototype._clearTimeout = function () {\n  if (!this._timer) return;\n  clearTimeout(this._timer);\n  this._timer = null;\n};\n\nexports.Promise.prototype.emitSuccess = function () {\n  if (this.hasFired) return;\n  this.hasFired = 'success';\n\n  this._clearTimeout();\n\n  this._values = Array.prototype.slice.call(arguments);\n  this.emit.apply(this, ['success'].concat(this._values));\n};\n\nexports.Promise.prototype.emitError = function () {\n  if (this.hasFired) return;\n  this.hasFired = 'error';\n\n  this._clearTimeout();\n\n  this._values = Array.prototype.slice.call(arguments);\n  this.emit.apply(this, ['error'].concat(this._values));\n\n  if (this.listeners('error').length == 0) {\n    var self = this;\n    process.nextTick(function () {\n      if (self.listeners('error').length == 0) {\n        throw self._values[0] instanceof Error ? self._values[0] : new Error('Unhandled emitError: ' + JSON.stringify(self._values));\n      }\n    });\n  }\n};\n\nexports.Promise.prototype.addCallback = function (listener) {\n  if (this.hasFired === 'success') {\n    listener.apply(this, this._values);\n  }\n\n  return this.addListener(\"success\", listener);\n};\n\nexports.Promise.prototype.addErrback = function (listener) {\n  if (this.hasFired === 'error') {\n    listener.apply(this, this._values);\n  }\n\n  return this.addListener(\"error\", listener);\n};","map":{"version":3,"sources":["/Users/alexyang/Desktop/todolist/Traffic-Generator/node_modules/amqp/lib/promise.js"],"names":["events","require","inherits","exports","Promise","EventEmitter","call","_blocking","hasFired","hasAcked","_values","undefined","prototype","timeout","_timeoutDuration","_clearTimeout","self","_timer","setTimeout","emitError","Error","clearTimeout","emitSuccess","Array","slice","arguments","emit","apply","concat","listeners","length","process","nextTick","JSON","stringify","addCallback","listener","addListener","addErrback"],"mappings":"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","sourcesContent":["var events = require('events');\nvar inherits = require('util').inherits;\n\nexports.Promise = function () {\n  events.EventEmitter.call(this);\n  this._blocking = false;\n  this.hasFired = false;\n  this.hasAcked = false;\n  this._values = undefined;\n};\ninherits(exports.Promise, events.EventEmitter);\n\nexports.Promise.prototype.timeout = function(timeout) {\n  if (!timeout) {\n    return this._timeoutDuration;\n  }\n\n  this._timeoutDuration = timeout;\n\n  if (this.hasFired) return;\n  this._clearTimeout();\n\n  var self = this;\n  this._timer = setTimeout(function() {\n    self._timer = null;\n    if (self.hasFired) {\n      return;\n    }\n\n    self.emitError(new Error('timeout'));\n  }, timeout);\n\n  return this;\n};\n\nexports.Promise.prototype._clearTimeout = function() {\n  if (!this._timer) return;\n\n  clearTimeout(this._timer);\n  this._timer = null;\n}\n\nexports.Promise.prototype.emitSuccess = function() {\n  if (this.hasFired) return;\n  this.hasFired = 'success';\n  this._clearTimeout();\n\n  this._values = Array.prototype.slice.call(arguments);\n  this.emit.apply(this, ['success'].concat(this._values));\n};\n\nexports.Promise.prototype.emitError = function() {\n  if (this.hasFired) return;\n  this.hasFired = 'error';\n  this._clearTimeout();\n\n  this._values = Array.prototype.slice.call(arguments);\n  this.emit.apply(this, ['error'].concat(this._values));\n\n  if (this.listeners('error').length == 0) {\n    var self = this;\n    process.nextTick(function() {\n      if (self.listeners('error').length == 0) {\n        throw (self._values[0] instanceof Error)\n          ? self._values[0]\n          : new Error('Unhandled emitError: '+JSON.stringify(self._values));\n      }\n    });\n  }\n};\n\nexports.Promise.prototype.addCallback = function (listener) {\n  if (this.hasFired === 'success') {\n    listener.apply(this, this._values);\n  }\n\n  return this.addListener(\"success\", listener);\n};\n\nexports.Promise.prototype.addErrback = function (listener) {\n  if (this.hasFired === 'error') {\n    listener.apply(this, this._values);\n  }\n\n  return this.addListener(\"error\", listener);\n};\n"]},"metadata":{},"sourceType":"script"}